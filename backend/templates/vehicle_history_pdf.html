{% load static %}
<!DOCTYPE html>
<html>
    <head>

        <meta charset="UTF-8">
        <link rel="stylesheet" href="{% static 'css/pdf_styles.css' %}">

        <style>
            @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap');
        </style>

    </head>

    <body>
        <div class="container">

            <!-- HEADER -->
            <div class="header">
                <h1>Raport Historii Pojazdu {{ vehicle.generation.model.make.name }} {{ vehicle.generation.model.name }}</h1>
                <h2>VIN: {{ vehicle.vin }}</h2>
            </div>


            <!-- DANE POJAZDU -->
            <div class="section-title">Dane pojazdu</div>
            <div class="box">
                <table>
                    <tr><td class="label">Marka</td><td>{{ vehicle.generation.model.make.name }}</td></tr>
                    <tr><td class="label">Model</td><td>{{ vehicle.generation.model.name }}</td></tr>
                    <tr><td class="label">Generacja</td><td>{{ vehicle.generation.name }}</td></tr>
                    <tr><td class="label">Rok produkcji</td><td>{{ vehicle.production_year }}</td></tr>
                    <tr><td class="label">VIN</td><td>{{ vehicle.vin }}</td></tr>
                </table>
            </div>


            <!-- PARAMETRY TECHNICZNE -->
            <div class="spec-strip">

                <div class="spec-item">
                    <!-- transmission -->
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">
                        <path fill="#ffffff" d="M259.1 73.5C262.1 58.7 275.2 48 290.4 48L350.2 48C365.4 48 378.5 58.7 381.5 73.5L396 143.5C410.1 149.5 423.3 157.2 435.3 166.3L503.1 143.8C517.5 139 533.3 145 540.9 158.2L570.8 210C578.4 223.2 575.7 239.8 564.3 249.9L511 297.3C511.9 304.7 512.3 312.3 512.3 320C512.3 327.7 511.8 335.3 511 342.7L564.4 390.2C575.8 400.3 578.4 417 570.9 430.1L541 481.9C533.4 495 517.6 501.1 503.2 496.3L435.4 473.8C423.3 482.9 410.1 490.5 396.1 496.6L381.7 566.5C378.6 581.4 365.5 592 350.4 592L290.6 592C275.4 592 262.3 581.3 259.3 566.5L244.9 496.6C230.8 490.6 217.7 482.9 205.6 473.8L137.5 496.3C123.1 501.1 107.3 495.1 99.7 481.9L69.8 430.1C62.2 416.9 64.9 400.3 76.3 390.2L129.7 342.7C128.8 335.3 128.4 327.7 128.4 320C128.4 312.3 128.9 304.7 129.7 297.3L76.3 249.8C64.9 239.7 62.3 223 69.8 209.9L99.7 158.1C107.3 144.9 123.1 138.9 137.5 143.7L205.3 166.2C217.4 157.1 230.6 149.5 244.6 143.4L259.1 73.5zM320.3 400C364.5 399.8 400.2 363.9 400 319.7C399.8 275.5 363.9 239.8 319.7 240C275.5 240.2 239.8 276.1 240 320.3C240.2 364.5 276.1 400.2 320.3 400z"/>
                    </svg>
                    {{ vehicle.transmission_type }}
                </div>

                <div class="spec-item">
                    <!-- fuel -->
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">
                        <path fill="#ffffff" d="M96 128C96 92.7 124.7 64 160 64L320 64C355.3 64 384 92.7 384 128L384 320L392 320C440.6 320 480 359.4 480 408L480 440C480 453.3 490.7 464 504 464C517.3 464 528 453.3 528 440L528 286C500.4 278.9 480 253.8 480 224L480 164.5L454.2 136.2C445.3 126.4 446 111.2 455.8 102.3C465.6 93.4 480.8 94.1 489.7 103.9L561.4 182.7C570.8 193 576 206.4 576 220.4L576 440C576 479.8 543.8 512 504 512C464.2 512 432 479.8 432 440L432 408C432 385.9 414.1 368 392 368L384 368L384 529.4C393.3 532.7 400 541.6 400 552C400 565.3 389.3 576 376 576L104 576C90.7 576 80 565.3 80 552C80 541.5 86.7 532.7 96 529.4L96 128zM160 144L160 240C160 248.8 167.2 256 176 256L304 256C312.8 256 320 248.8 320 240L320 144C320 135.2 312.8 128 304 128L176 128C167.2 128 160 135.2 160 144z"/>
                    </svg>
                    {{ vehicle.fuel_type }}
                </div>

                <div class="spec-item">
                    <!-- location -->
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">
                        <path fill="#ffffff" d="M576 112C576 103.7 571.7 96 564.7 91.6C557.7 87.2 548.8 86.8 541.4 90.5L416.5 152.1L244 93.4C230.3 88.7 215.3 89.6 202.1 95.7L77.8 154.3C69.4 158.2 64 166.7 64 176L64 528C64 536.2 68.2 543.9 75.1 548.3C82 552.7 90.7 553.2 98.2 549.7L225.5 489.8L396.2 546.7C409.9 551.3 424.7 550.4 437.8 544.2L562.2 485.7C570.6 481.7 576 473.3 576 464L576 112zM208 146.1L208 445.1L112 490.3L112 191.3L208 146.1zM256 449.4L256 148.3L384 191.8L384 492.1L256 449.4zM432 198L528 150.6L528 448.8L432 494L432 198z"/>
                    </svg>
                    {{ vehicle.location }}
                </div>

                <div class="spec-item">
                    <!-- calendar -->
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">
                        <path fill="#ffffff" d="M216 64C229.3 64 240 74.7 240 88L240 128L400 128L400 88C400 74.7 410.7 64 424 64C437.3 64 448 74.7 448 88L448 128L480 128C515.3 128 544 156.7 544 192L544 480C544 515.3 515.3 544 480 544L160 544C124.7 544 96 515.3 96 480L96 192C96 156.7 124.7 128 160 128L192 128L192 88C192 74.7 202.7 64 216 64zM216 176L160 176C151.2 176 144 183.2 144 192L144 240L496 240L496 192C496 183.2 488.8 176 480 176L216 176zM144 288L144 480C144 488.8 151.2 496 160 496L480 496C488.8 496 496 488.8 496 480L496 288L144 288z"/>
                    </svg>
                    {{ vehicle.production_year }}
                </div>

                <div class="spec-item">
                    <!-- odometer -->
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">
                        <path fill="#ffffff" d="M64 320C64 178.6 178.6 64 320 64C461.4 64 576 178.6 576 320C576 461.4 461.4 576 320 576C178.6 576 64 461.4 64 320zM352 160C352 142.3 337.7 128 320 128C302.3 128 288 142.3 288 160C288 177.7 302.3 192 320 192C337.7 192 352 177.7 352 160zM320 480C355.3 480 384 451.3 384 416C384 399.8 378 384.9 368 373.7L437.5 234.8C443.4 222.9 438.6 208.5 426.8 202.6C415 196.7 400.5 201.5 394.6 213.3L325.1 352.2C323.4 352.1 321.7 352 320 352C284.7 352 256 380.7 256 416C256 451.3 284.7 480 320 480zM240 208C240 190.3 225.7 176 208 176C190.3 176 176 190.3 176 208C176 225.7 190.3 240 208 240C225.7 240 240 225.7 240 208zM160 352C177.7 352 192 337.7 192 320C192 302.3 177.7 288 160 288C142.3 288 128 302.3 128 320C128 337.7 142.3 352 160 352zM512 320C512 302.3 497.7 288 480 288C462.3 288 448 302.3 448 320C448 337.7 462.3 352 480 352C497.7 352 512 337.7 512 320z"/>
                    </svg>
                    {{ vehicle.odometer }} km
                </div>

                <div class="spec-item">
                    {{ vehicle.price }} PLN
                </div>

            </div>



            <!-- HISTORIA SERWISOWA -->
            <div class="section-title">Historia serwisowa</div>
            <div class="box">
                {% if service_entries %}
                    {% for s in service_entries %}
                        <div class="entry">
                            <div class="entry-data">
                                <div class="entry-date">ðŸ“… {{ s.date }} â€“ {{ s.mileage }} km</div>
                                <div class="entry-desc">{{ s.description }}</div>
                                {% if s.cost %}
                                    <div class="entry-cost">ðŸ’° Koszt: {{ s.cost }} PLN</div>
                                {% endif %}
                            </div>

                            {% if s.invoice_image %}
                            <div class="entry-photo">
                                <img src="{{ s.invoice_image.url }}" alt="Faktura">
                            </div>
                            {% endif %}
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="no-data">Brak wpisÃ³w serwisowych</div>
                {% endif %}
            </div>


            <!-- HISTORIA SZKÃ“D -->
            <div class="section-title">Historia szkÃ³d</div>
            <div class="box">
                {% if damage_entries %}
                    {% for d in damage_entries %}
                        <div class="entry damage">
                            <div class="entry-data">
                                <div class="entry-date">ðŸ“… {{ d.date }}</div>
                                <div class="entry-desc">{{ d.description }}</div>
                            </div>

                           
                            <div class="entry-photo marker-container">
                                <img src="{{ context }}auto-linienziehbaren.jpg" alt="Lokalizacja uszkodzeÅ„" >
                                
                                {% if d.markers.all %}
                                    {% for m in d.markers.all %}
                                    <div class="marker marker-{{ m.severity }}" 
                                        style="--x: {{ m.x_percent }}%; --y: {{ m.y_percent }}%;"
                                        title="{{ m.get_severity_display }} - ({{ m.x_percent }}%, {{ m.y_percent }}%)" 
                                        data-severity="{{ m.severity }}">
                                    </div>

                                    {% endfor %}
                                {% endif %}
                            </div>
                           
                        </div>

                        <!-- Sekcja wszystkich zdjÄ™Ä‡ do wpisu -->
                        {% if d.photos.all %}
                        <div class="entry-photos-gallery">
                            {% for photo in d.photos.all %}
                            <div class="photo">
                                <img src="{{ photo.image.url }}" alt="ZdjÄ™cie uszkodzenia">
                            </div>
                            {% endfor %}
                        </div>
                        {% endif %}

                    {% endfor %}
                {% else %}
                    <div class="no-data">Brak zgÅ‚oszonych szkÃ³d</div>
                {% endif %}
            </div>



            <!-- FOOTER -->
            <div class="footer">
                Wygenerowano automatycznie: {% now "Y-m-d H:i" %} | GaraZero Â© 2025
            </div>

        </div>
    </body>
</html>
