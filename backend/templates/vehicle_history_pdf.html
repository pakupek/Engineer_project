{% load static %}
<!DOCTYPE html>
<html>
    <head>

        <meta charset="UTF-8">
        <link rel="stylesheet" href="{% static 'pdf_styles.css' %}">

        <style>
            @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap');
        </style>

    </head>

    <body>
        <div class="container">

            <!-- HEADER -->
            <div class="header">
                <h1>Raport Historii Pojazdu {{ vehicle.generation.model.make.name }} {{ vehicle.generation.model.name }}</h1>
                <h2>VIN: {{ vehicle.vin }}</h2>
            </div>


            <!-- DANE POJAZDU -->
            <div class="section-title">Dane pojazdu</div>
            <div class="box">
                <table>
                    <tr><td class="label">Marka</td><td>{{ vehicle.generation.model.make.name }}</td></tr>
                    <tr><td class="label">Model</td><td>{{ vehicle.generation.model.name }}</td></tr>
                    <tr><td class="label">Generacja</td><td>{{ vehicle.generation.name }}</td></tr>
                    <tr><td class="label">Rok produkcji</td><td>{{ vehicle.production_year }}</td></tr>
                    <tr><td class="label">VIN</td><td>{{ vehicle.vin }}</td></tr>
                </table>
            </div>


            <!-- PARAMETRY TECHNICZNE ‚Äì PREMIUM STRIP -->
            <div class="spec-strip">
                <div class="spec-item">‚öôÔ∏è {{ vehicle.transmission_type }}</div>
                <div class="spec-item">‚õΩ {{ vehicle.fuel_type }}</div>
                <div class="spec-item">üìç {{ vehicle.location }}</div>
                <div class="spec-item">üìÖ {{ vehicle.production_year }}</div>
                <div class="spec-item">üöó {{ vehicle.odometer }} km</div>
                <div class="spec-item">üí∞ {{ vehicle.price }} PLN</div>
            </div>


            <!-- HISTORIA SERWISOWA -->
            <div class="section-title">Historia serwisowa</div>
            <div class="box">
                {% if service_entries %}
                    {% for s in service_entries %}
                        <div class="entry">
                            <div class="entry-data">
                                <div class="entry-date">üìÖ {{ s.date }} ‚Äì {{ s.mileage }} km</div>
                                <div class="entry-desc">{{ s.description }}</div>
                                {% if s.cost %}
                                    <div class="entry-cost">üí∞ Koszt: {{ s.cost }} PLN</div>
                                {% endif %}
                            </div>

                            {% if s.invoice_image %}
                            <div class="entry-photo">
                                <img src="{{ s.invoice_image.url }}" alt="Faktura">
                            </div>
                            {% endif %}
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="no-data">Brak wpis√≥w serwisowych</div>
                {% endif %}
            </div>


            <!-- HISTORIA SZK√ìD -->
            <div class="section-title">Historia szk√≥d</div>
            <div class="box">
                {% if damage_entries %}
                    {% for d in damage_entries %}
                        <div class="entry damage">
                            <div class="entry-data">
                                <div class="entry-date">üìÖ {{ d.date }}</div>
                                <div class="entry-desc">{{ d.description }}</div>
                            </div>

                           
                            <div class="entry-photo marker-container">
                                <img src="{% static 'images/auto-linienziehbaren.jpg' %}" alt="Lokalizacja uszkodze≈Ñ" >
                                
                                {% if d.markers.all %}
                                    {% for m in d.markers.all %}
                                    <div class="marker marker-{{ m.severity }}" 
                                        style="--x: {{ m.x_percent }}%; --y: {{ m.y_percent }}%;"
                                        title="{{ m.get_severity_display }} - ({{ m.x_percent }}%, {{ m.y_percent }}%)" 
                                        data-severity="{{ m.severity }}">
                                    </div>

                                    {% endfor %}
                                {% endif %}
                            </div>
                           
                        </div>

                        <!-- Sekcja wszystkich zdjƒôƒá do wpisu -->
                        {% if d.photos.all %}
                        <div class="entry-photos-gallery">
                            {% for photo in d.photos.all %}
                            <div class="photo">
                                <img src="{{ photo.image.url }}" alt="Zdjƒôcie uszkodzenia">
                            </div>
                            {% endfor %}
                        </div>
                        {% endif %}

                    {% endfor %}
                {% else %}
                    <div class="no-data">Brak zg≈Çoszonych szk√≥d</div>
                {% endif %}
            </div>



            <!-- FOOTER -->
            <div class="footer">
                Wygenerowano automatycznie: {% now "Y-m-d H:i" %} | GaraZero ¬© 2025
            </div>

        </div>
    </body>
</html>
